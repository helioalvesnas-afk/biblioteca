CREATE TABLE ROLE (
    ID BIGINT,
    NOME VARCHAR(50) NOT NULL UNIQUE
);
CREATE UNIQUE INDEX ROLE_ID_IDX ON ROLE(ID);
ALTER TABLE ROLE ADD CONSTRAINT ROLE_PKY PRIMARY KEY USING INDEX ROLE_ID_IDX;
CREATE SEQUENCE ROLE_SEQ
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER TABLE ROLE ALTER COLUMN ID SET DEFAULT NEXTVAL('ROLE_SEQ');


CREATE TABLE USUARIO (
    ID BIGINT,
    USERNAME VARCHAR(100) NOT NULL UNIQUE,
    PASSWORD VARCHAR(255) NOT NULL
);
CREATE UNIQUE INDEX USUARIO_ID_IDX ON USUARIO(ID);
ALTER TABLE USUARIO ADD CONSTRAINT USUARIO_PKY PRIMARY KEY USING INDEX USUARIO_ID_IDX;
CREATE SEQUENCE USUARIO_SEQ
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER TABLE USUARIO ALTER COLUMN ID SET DEFAULT NEXTVAL('USUARIO_SEQ');


CREATE TABLE USUARIO_ROLE (
    USUARIO_ID BIGINT NOT NULL,
    ROLE_ID BIGINT NOT NULL,
    PRIMARY KEY (USUARIO_ID, ROLE_ID),
    FOREIGN KEY (USUARIO_ID) REFERENCES USUARIO(ID) ON DELETE CASCADE,
    FOREIGN KEY (ROLE_ID) REFERENCES ROLE(ID) ON DELETE CASCADE
);
CREATE UNIQUE INDEX ID_USUARIO_ROLE_IDX ON USUARIO_ROLE(USUARIO_ID, ROLE_ID);


CREATE TABLE AUTOR (
    ID INT,
    NOME VARCHAR(150) NOT NULL
);
CREATE UNIQUE INDEX AUTOR_ID_IDX ON AUTOR(ID);
ALTER TABLE AUTOR ADD CONSTRAINT AUTOR_PKY PRIMARY KEY USING INDEX AUTOR_ID_IDX;
CREATE SEQUENCE AUTOR_SEQ
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER TABLE AUTOR ALTER COLUMN ID SET DEFAULT NEXTVAL('AUTOR_SEQ');


CREATE TABLE GENERO (
    ID INT,
    NOME VARCHAR(100) NOT NULL
);
CREATE UNIQUE INDEX GENERO_ID_IDX ON GENERO(ID);
ALTER TABLE GENERO ADD CONSTRAINT GENERO_PKY PRIMARY KEY USING INDEX GENERO_ID_IDX;
CREATE SEQUENCE GENERO_SEQ
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER TABLE GENERO ALTER COLUMN ID SET DEFAULT NEXTVAL('GENERO_SEQ');


CREATE TABLE LIVRO (
    ID INT,
    TITULO VARCHAR(200) NOT NULL,
    ANO_PUBLICACAO INT,
    AUTOR_ID INT NOT NULL,
    GENERO_ID INT NOT NULL,
    FOREIGN KEY (AUTOR_ID) REFERENCES AUTOR(ID),
    FOREIGN KEY (GENERO_ID) REFERENCES GENERO(ID)
);
CREATE UNIQUE INDEX LIVRO_ID_IDX ON LIVRO(ID);
ALTER TABLE LIVRO ADD CONSTRAINT LIVRO_PKY PRIMARY KEY USING INDEX LIVRO_ID_IDX;
CREATE SEQUENCE LIVRO_SEQ
    INCREMENT 1
    START 1
    MINVALUE 1
    MAXVALUE 9223372036854775807
    CACHE 1;
ALTER TABLE LIVRO ALTER COLUMN ID SET DEFAULT NEXTVAL('LIVRO_SEQ');